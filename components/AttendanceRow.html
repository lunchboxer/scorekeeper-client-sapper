<li class:present="status ==='present'" on:click="changeStatus()">
  <span class="check">&#10004;</span>
  <span class="name">{student.englishName || student.chineseName}</span>
</li>

<style>
  li {
    list-style-type: none;
    padding: 1rem;
    margin: 1rem 0;
    border: 1px solid #eeeeee;
    cursor: pointer;
    color: grey;
    max-width: 50rem;
  }

  li:hover {
    color: var(--base-color);
  }

  .check {
    font-size: 2.5rem;
    padding: 0.4rem;
    margin: 0.4rem;
    visibility: hidden;
  }

  li.present {
    color: var(--primary-color);
    font-weight: 400;
    border: 1px solid var(--primary-color);
  }

  li.present .check {
    visibility: visible;
  }
</style>

<script>
  import client from '../utils/feathers.js'
  export default {
    computed: {
      attendance: ({ $attendances, student }) => $attendances.find(attendance => attendance.student === student.id),
      status: ({ attendance }) => {
        return attendance ? attendance.status : 'none'
      }
    },
    methods: {
      changeStatus() {
        const { attendance, status, student } = this.get()
        const { session } = this.store.get()
        if (status === 'none') {
          client.service('attendances').create({ status: "present", student: student.id, session: session.id })
        } else {
          const newStatus = (status === "present") ? "absent" : "present"
          client.service('attendances').patch(attendance.id, { status: newStatus })
        }
      }
    }
  }
</script>